@model EmployeeManagementSystem.Models.Payslip

@{
    ViewData["Title"] = "View Payslip";
}

<div class="container py-4">
    <div class="row mb-4">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center">
                <h2 class="text-gradient">
                    <i class="fas fa-file-invoice me-2"></i>Payslip
                </h2>
                <div>
                    <button onclick="window.print()" class="btn btn-primary">
                        <i class="fas fa-print me-2"></i>Print
                    </button>
                    <a asp-action="Index" class="btn btn-outline-primary no-print">
                        <i class="fas fa-arrow-left me-2"></i>Back
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Payslip Container -->
    <div class="row">
        <div class="col-12">
            <div class="payslip-container" id="payslip">
                <!-- Company Header -->
                <div class="payslip-header text-center">
                    <h3 class="text-primary mb-1">Employee Management System</h3>
                    <p class="text-muted mb-0">Payslip for @System.Globalization.CultureInfo.CurrentCulture.DateTimeFormat.GetMonthName(Model.Month) @Model.Year</p>
                </div>

                <!-- Employee Details -->
                <div class="row mt-4">
                    <div class="col-md-6">
                        <h6 class="text-uppercase text-muted mb-3">Employee Details</h6>
                        <p class="mb-2"><strong>Employee ID:</strong> EMP-@Model.EmployeeId.ToString("D4")</p>
                        <p class="mb-2"><strong>Name:</strong> @Model.Employee.FirstName @Model.Employee.LastName</p>
                        <p class="mb-2"><strong>Position:</strong> @Model.Employee.Position</p>
                        <p class="mb-2"><strong>Department:</strong> @Model.Employee.Department</p>
                    </div>
                    <div class="col-md-6 text-md-end">
                        <h6 class="text-uppercase text-muted mb-3">Payslip Details</h6>
                        <p class="mb-2"><strong>Payslip ID:</strong> PAY-@Model.PayslipId.ToString("D5")</p>
                        <p class="mb-2"><strong>Month/Year:</strong> @System.Globalization.CultureInfo.CurrentCulture.DateTimeFormat.GetMonthName(Model.Month) @Model.Year</p>
                        <p class="mb-2"><strong>Generated Date:</strong> @Model.GeneratedDate.ToString("dd MMM yyyy")</p>
                        <p class="mb-2">
                            <strong>Status:</strong>
                            @if (Model.Status == "Paid")
                            {
                                <span class="badge bg-success">Paid</span>
                            }
                            else
                            {
                                <span class="badge bg-warning">Generated</span>
                            }
                        </p>
                    </div>
                </div>

                <hr class="my-4" />

                <!-- Attendance Summary -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6 class="text-uppercase text-muted mb-3">Attendance Summary</h6>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="d-flex justify-content-between mb-2">
                                    <span>Total Working Days:</span>
                                    <strong>@Model.WorkingDays</strong>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="d-flex justify-content-between mb-2">
                                    <span>Days Present:</span>
                                    <strong class="text-success">@Model.PresentDays</strong>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Earnings -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6 class="text-uppercase text-muted mb-3">Earnings</h6>
                        <div class="payslip-row">
                            <span>Basic Salary</span>
                            <strong>?@Model.BasicSalary.ToString("N2")</strong>
                        </div>
                        <div class="payslip-row">
                            <span>Bonus</span>
                            <strong class="text-success">?@Model.Bonus.ToString("N2")</strong>
                        </div>
                        <div class="payslip-row bg-light">
                            <span class="fw-bold">Gross Salary</span>
                            <strong>?@((Model.BasicSalary + Model.Bonus).ToString("N2"))</strong>
                        </div>
                    </div>
                </div>

                <!-- Deductions -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6 class="text-uppercase text-muted mb-3">Deductions</h6>
                        <div class="payslip-row">
                            <span>Total Deductions</span>
                            <strong class="text-danger">?@Model.Deductions.ToString("N2")</strong>
                        </div>
                    </div>
                </div>

                <!-- Net Salary -->
                <div class="payslip-total">
                    <div class="d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">NET SALARY</h5>
                        <h4 class="mb-0">?@Model.NetSalary.ToString("N2")</h4>
                    </div>
                </div>

                <!-- Footer -->
                <div class="mt-5 pt-4 border-top text-center">
                    <p class="text-muted mb-0">
                        <small>This is a computer-generated payslip and does not require a signature.</small>
                    </p>
                    <p class="text-muted mb-0">
                        <small>Generated on @DateTime.Now.ToString("dd MMM yyyy, hh:mm tt")</small>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Prevent navigation buttons from showing in print
        window.onbeforeprint = function() {
            document.querySelectorAll('.no-print').forEach(el => el.style.display = 'none');
        };
        window.onafterprint = function() {
            document.querySelectorAll('.no-print').forEach(el => el.style.display = '');
        };
    </script>
}
